<div {{ attributes.defaults({class: 'sidebar-wrapper active'}) }} >
    <div class="sidebar-header position-relative">
        <div class="d-flex justify-content-between align-items-center">
            <div class="logo">
                <a href="{{ path('home') }}"><img src="{{ asset('images/logo/bebou-logo.svg') }}" alt="{{ 'app_name'|trans }}"></a>
            </div>
            <div class="theme-toggle d-flex gap-2  align-items-center mt-2">
                <twig:ux:icon name="line-md:sunny-outline-loop" style="width: 22px; height: 22px;"/>
                <div data-controller="dark" class="form-check form-switch fs-6 px-0">
                    <input class="form-check-input mx-0" type="checkbox" id="toggle-dark" style="cursor: pointer">
                    <label class="form-check-label"></label>
                </div>
                <twig:ux:icon name="line-md:moon" style="width: 22px; height: 22px;"/>
            </div>
            <div class="sidebar-toggler  x">
                <a href="#" class="sidebar-hide d-xl-none d-block"><i class="bi bi-x bi-middle"></i></a>
            </div>
        </div>
    </div>
    <div class="sidebar-menu">
        <ul class="menu">
            {% for sidebarItem in this.items %}
                {% if sidebarItem.isTitle == true %}
                    <li class="sidebar-title">{{ sidebarItem.name|trans }}</li>
                {% else %}
                    {% set hasSubMenuActive = false %}
                    {% if sidebarItem.subMenu is defined %}
                        {% for sub in sidebarItem.subMenu %}
                            {% if sub.url == app.current_route %}
                                {% set hasSubMenuActive = true %}
                            {% endif %}
                            {% if sub.subMenu|default({})|length > 0 %}
                                {% for subsub in sub.submenu %}
                                    {% if subsub.url == app.current_route %}
                                        {% set hasSubMenuActive = true %}
                                    {% endif %}
                                {% endfor %}
                            {% endif %}
                            {% if app.current_route in sub.activeByHiddenChildren|default({}) %}
                                {% set hasSubMenuActive = true %}
                            {% endif %}
                        {% endfor %}
                    {% endif %}

                    <li class="sidebar-item {% if sidebarItem.url|default(null) == app.current_route or hasSubMenuActive == true %}active{% endif %} {% if sidebarItem.subMenu is defined and sidebarItem.subMenu|length > 0 %}has-sub{% endif %}">
                        <a href="{% if sidebarItem.url|default(null) is not null %}{{ path(sidebarItem.url) }}{% else %}#{% endif %}" class='sidebar-link'>
                            {% if sidebarItem.pictureType == constant('PICTURE_TYPE_EMOJI', this) %}
                                <div class="fs-6">{{ sidebarItem.emoji }}</div>
                            {% else %}
                                <i class="bi bi-{{ sidebarItem.icon }}"></i>
                            {% endif %}
                            <span>{{ sidebarItem.name|trans }}</span>
                        </a>
                        {% if sidebarItem.subMenu is defined and sidebarItem.subMenu|length > 0 %}
                            <ul class="submenu {% if hasSubMenuActive == true %}active{% endif %}">
                                {% for sub in sidebarItem.subMenu %}
                                    {% set isSubActive = sub.url == app.current_route or app.current_route in sub.activeByHiddenChildren|default({}) %}
                                    <li class="submenu-item {% if isSubActive %}active{% endif %} {% if sub.subMenu|default({})|length > 0 %}has-sub{% endif %}">
                                        <a href="{{ path(sub.url) }}" class="submenu-link">{{ sub.name|trans }}</a>
                                        {% if sub.subMenu|default({})|length > 0 %}
                                            <ul class="submenu submenu-level-2 ">
                                                {% for subsub in sub.submenu %}
                                                    <li class="submenu-item {% if subsub.url == app.current_route %}active{% endif %}">
                                                        <a href="{{ path(subsub.url) }}" class="submenu-link">{{ subsub.name|trans }}</a>
                                                    </li>
                                                {% endfor %}
                                            </ul>
                                        {% endif %}
                                    </li>
                                {% endfor %}
                            </ul>
                        {% endif %}
                    </li>
            {% endif %}{% endfor %}
        </ul>
    </div>
</div>
